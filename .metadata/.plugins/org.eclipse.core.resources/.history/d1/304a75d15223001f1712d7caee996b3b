<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoteles</title>
    <link rel="stylesheet" href="/css/vuelos.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
</head>
<body>
    <h1>Estos son los vuelos disponibles...</h1>
	<h3>Introduza el número de plazas que dessea reservar para ver los vuelos con suficientes plazas: </h3>
	<form action="/vuelos/buscar" method="get" class="search-container">
        <input type="text" id="numPlazas" placeholder="Número de plazas a reservar..."/>
        <button onClick="obtenerNumPlazasAReservar()"id="botonBuscar" type="submit">Buscar</button>
	</form>
    
	<table class="tablaConVuelos">
	    <thead>
	        <tr>
	            <th>Compañía</th>
	            <th>Fecha</th>
	            <th>Precio</th>
	            <th>Plazas restantes</th>
	            <th>Reservar vuelo</th>
	        </tr>
	    </thead>
	    <tbody id="vueloTableBody">
	        <tr th:each="vuelo : ${vuelos}" class="vuelo">
	            <td th:text="${vuelo.aerolinea}"></td>
	            <td th:text="${vuelo.fechaVuelo}"></td>
	            <td th:text="${vuelo.precio} + '€'"></td>
	            <td th:text="${vuelo.plazasDisponibles}"></td>
				<a><button class="botonReservar" type="submit">Reservar</button></a>
	            <td>
				</tr>
	                <form action="/vuelos/reservar" method="get" onsubmit="obtenerDatosFila(this)">
	                    <input type="hidden" name="plazasAReservar" id="inputOculto">
	                    <input type="hidden" name="id" th:value="${vuelo.id}">
	                    
	                </form>
	            </td>
	    </tbody>
	</table>
	<script>
			    var inputEspecifico = document.getElementById("numPlazas");
			    var valor = inputEspecifico.value;
				document.getElementById("inputOculto").value = valor;
				
				function obtenerDatosFila(formulario) {
				        var fila = formulario.closest('tr'); // Obtener la fila más cercana al formulario
				        var celdas = fila.getElementsByTagName('td'); // Obtener todas las celdas de la fila
				        
				        // Obtener los valores de los <td>
				        var compañia = celdas[0].textContent;
				        var fecha = celdas[1].textContent;
				        var precio = celdas[2].textContent;
				        
				        // Obtener los valores de los <input> dentro del formulario
				        var plazasAReservar = formulario.querySelector('input[name="plazasAReservar"]').value;
				        var id = formulario.querySelector('input[name="id"]').value;
				        
				        // Puedes hacer lo que quieras con los valores aquí, como enviarlos a través de AJAX
				        console.log("Compañía: " + compañia + ", Fecha: " + fecha + ", Precio: " + precio);
				        console.log("Plazas a reservar: " + plazasAReservar + ", ID: " + id);
				    }
	</script>
</body>
</html>
